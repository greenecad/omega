{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Pending Submissions{% endblock %}</h1>
{% endblock %}

{% block content %}
  <table>
    <thead>
      <tr>
        <th>Username</th>
        <th>Challenge ID</th>
        <th>image</th>
        <th>file name</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      {% for challenge_id, submission in json.loads(user[1])['challenges'].items() %}
      {% if submission[0] == 'pending' %}
        <tr>
          <td>{{ user[0] }}</td>
          <td>{{ challenge_id }}</td>
          <td>
            <img src="{{ url_for('static', filename=('img/' + 'users/' + user[0] + '/submissions/' + submission[1])) }}" alt="Submission Image" width="200">
          </td>
          <td>{{ submission[1] }}</td>
          <td>
          <form method="post" action="{{ url_for('main.admin_pending') }}">
            <input type="hidden" name="username" value="{{ user[0] }}">
            <input type="hidden" name="challenge_id" value="{{ challenge_id }}">
            <button type="submit" name="action" value="approve">Approve</button>
            <button type="submit" name="action" value="reject">Reject</button>
          </form>
          </td>
          <td>{{ submission[1] }}</td>
        </tr>
      {% endif %}
      {% endfor %}
      {% endfor %}
    </tbody>
  </table>
{% endblock %}